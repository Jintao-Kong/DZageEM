%% yield sigmaage k = 18
function [sigmaage,sigmaall] = confidence18KDE1(data,weight,group,sigma)

deltaweight = 0.01; deltaage = 1;
bzc = [sigma(1),sigma(2),sigma(3),sigma(4),sigma(5),sigma(6),...
    sigma(7),sigma(8),sigma(9),sigma(10),sigma(11),sigma(12),sigma(13),...
    sigma(14),sigma(15),sigma(16),sigma(17),sigma(18)];

result = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

result1 = result((~isinf(result)));
Likelihood18 = sum(result1);

%calculate sigma11
sigma111 = -log(weight(1).*distribution(data(:,1),bzc(1),(group(1)+deltaage))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma112 = -log(weight(1).*distribution(data(:,1),bzc(1),(group(1)-deltaage))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma111 = sigma111((~isinf(sigma111)));
sigma112 = sigma112((~isinf(sigma112)));
sigma11 = (sum(sigma111)+sum(sigma112)-2.*Likelihood18)./(deltaage.^2);

%calculate sigma22
sigma221 = -log((weight(1)+deltaweight).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma222 = -log((weight(1)-deltaweight).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));
sigma221 = sigma221((~isinf(sigma221)));
sigma222 = sigma222((~isinf(sigma222)));
sigma22 = (sum(sigma221)+sum(sigma222)-2.*Likelihood18)./(deltaweight.^2);

%calculate sigma33
sigma331 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),(group(2)+deltaage))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma332 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),(group(2)-deltaage))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma331 = sigma331((~isinf(sigma331)));
sigma332 = sigma332((~isinf(sigma332)));
sigma33 = (sum(sigma331)+sum(sigma332)-2.*Likelihood18)./(deltaage.^2);

%calculate sigma44
sigma441 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    (weight(2)+deltaweight).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma442 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    (weight(2)-deltaweight).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));
sigma441 = sigma441((~isinf(sigma441)));
sigma442 = sigma442((~isinf(sigma442)));
sigma44 = (sum(sigma441)+sum(sigma442)-2.*Likelihood18)./(deltaweight.^2);

%calculate sigma55
sigma551 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),(group(3)+deltaage))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma552 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),(group(3)-deltaage))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));
sigma551 = sigma551((~isinf(sigma551)));
sigma552 = sigma552((~isinf(sigma552)));
sigma55 = (sum(sigma551)+sum(sigma552)-2.*Likelihood18)./(deltaage.^2);

%calculate sigma66
sigma661 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    (weight(3)+deltaweight).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma662 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(1),group(2))+...
    (weight(3)-deltaweight).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma661 = sigma661((~isinf(sigma661)));
sigma662 = sigma662((~isinf(sigma662)));
sigma66 = (sum(sigma661)+sum(sigma662)-2.*Likelihood18)./(deltaweight.^2);

%calculate sigma77
sigma771 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),(group(4)+deltaage))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma772 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),(group(4)-deltaage))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma771 = sigma771((~isinf(sigma771)));
sigma772 = sigma772((~isinf(sigma772)));
sigma77 = (sum(sigma771)+sum(sigma772)-2.*Likelihood18)./(deltaage.^2);

%calculate sigma88
sigma881 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    (weight(4)+deltaweight).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma882 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    (weight(4)-deltaweight).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));
sigma881 = sigma881((~isinf(sigma881)));
sigma882 = sigma882((~isinf(sigma882)));
sigma88 = (sum(sigma881)+sum(sigma882)-2.*Likelihood18)./(deltaweight.^2);

%calculate sigma99
sigma991= -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),(group(5)+deltaage))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma992 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),(group(5)-deltaage))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma991 = sigma991((~isinf(sigma991)));
sigma992 = sigma992((~isinf(sigma992)));
sigma99 = (sum(sigma991)+sum(sigma992)-2.*Likelihood18)./(deltaage.^2);

%calculate sigma1010
sigma10101 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    (weight(5)+deltaweight).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma10102 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    (weight(5)-deltaweight).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma10101 = sigma10101((~isinf(sigma10101)));
sigma10102 = sigma10102((~isinf(sigma10102)));
sigma1010 = (sum(sigma10101)+sum(sigma10102)-2.*Likelihood18)./(deltaweight.^2);

%calculate sigma1111
sigma11111 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),(group(6)+deltaage))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma11112 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),(group(6)-deltaage))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma11111 = sigma11111((~isinf(sigma11111)));
sigma11112 = sigma11112((~isinf(sigma11112)));
sigma1111 = (sum(sigma11111)+sum(sigma11112)-2.*Likelihood18)./(deltaage.^2);

%calculate sigma1212
sigma12121 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    (weight(6)+deltaweight).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma12122 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    (weight(6)-deltaweight).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));
sigma12121 = sigma12121((~isinf(sigma12121)));
sigma12122 = sigma12122((~isinf(sigma12122)));
sigma1212 = (sum(sigma12121)+sum(sigma12122)-2.*Likelihood18)./(deltaweight.^2);

%calculate sigma1313
sigma13131 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),(group(7)-deltaage))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma13132 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),(group(7)+deltaage))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma13131 = sigma13131((~isinf(sigma13131)));
sigma13132 = sigma13132((~isinf(sigma13132)));
sigma1313 = (sum(sigma13131)+sum(sigma13132)-2.*Likelihood18)./(deltaage.^2);

%calculate sigma1414
sigma14141 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    (weight(7)+deltaweight).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma14142 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    (weight(7)-deltaweight).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma14141 = sigma14141((~isinf(sigma14141)));
sigma14142 = sigma14142((~isinf(sigma14142)));
sigma1414 = (sum(sigma14141)+sum(sigma14142)-2.*Likelihood18)./(deltaweight.^2);

%calculate sigma1515
sigma15151 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),(group(8)-deltaage))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma15152 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),(group(8)+deltaage))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma15151 = sigma15151((~isinf(sigma15151)));
sigma15152 = sigma15152((~isinf(sigma15152)));
sigma1515 = (sum(sigma15151)+sum(sigma15152)-2.*Likelihood18)./(deltaage.^2);

%calculate sigma1616
sigma16161 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    (weight(8)+deltaweight).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma16162 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    (weight(8)-deltaweight).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma16161 = sigma16161((~isinf(sigma16161)));
sigma16162 = sigma16162((~isinf(sigma16162)));
sigma1616 = (sum(sigma16161)+sum(sigma16162)-2.*Likelihood18)./(deltaweight.^2);

%calculate sigma1717
sigma17171 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),(group(9)+deltaage))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma17172 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),(group(9)-deltaage))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));
sigma17171 = sigma17171((~isinf(sigma17171)));
sigma17172 = sigma17172((~isinf(sigma17172)));
sigma1717 = (sum(sigma17171)+sum(sigma17172)-2.*Likelihood18)./(deltaage.^2);

%calculate sigma1818
sigma18181 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    (weight(9)+deltaweight).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma18182 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    (weight(9)-deltaweight).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma18181 = sigma18181((~isinf(sigma18181)));
sigma18182 = sigma18182((~isinf(sigma18182)));
sigma1818 = (sum(sigma18181)+sum(sigma18182)-2.*Likelihood18)./(deltaweight.^2);

%calculate sigma1919
sigma19191 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),(group(10)+deltaage))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma19192 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),(group(10)-deltaage))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));
sigma19191 = sigma19191((~isinf(sigma19191)));
sigma19192 = sigma19192((~isinf(sigma19192)));
sigma1919 = (sum(sigma19191)+sum(sigma19192)-2.*Likelihood18)./(deltaage.^2);

%calculate sigma2020
sigma20201 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    (weight(10)+deltaweight).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma20202 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    (weight(10)-deltaweight).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));
sigma20201 = sigma20201((~isinf(sigma20201)));
sigma20202 = sigma20202((~isinf(sigma20202)));
sigma2020 = (sum(sigma20201)+sum(sigma20202)-2.*Likelihood18)./(deltaweight.^2);

%calculate sigma2121
sigma21211 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),(group(11)-deltaage))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma21212 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),(group(11)+deltaage))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));
sigma21211 = sigma21211((~isinf(sigma21211)));
sigma21212 = sigma21212((~isinf(sigma21212)));
sigma2121 = (sum(sigma21211)+sum(sigma21212)-2.*Likelihood18)./(deltaage.^2);

%calculate sigma2222
sigma22221 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    (weight(11)+deltaweight).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma22222 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    (weight(11)-deltaweight).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma22221 = sigma22221((~isinf(sigma22221)));
sigma22222 = sigma22222((~isinf(sigma22222)));
sigma2222 = (sum(sigma22221)+sum(sigma22222)-2.*Likelihood18)./(deltaweight.^2);

%calculate sigma2323
sigma23231 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),(group(12)-deltaage))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma23232 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),(group(12)+deltaage))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma23231 = sigma23231((~isinf(sigma23231)));
sigma23232 = sigma23232((~isinf(sigma23232)));
sigma2323 = (sum(sigma23231)+sum(sigma23232)-2.*Likelihood18)./(deltaage.^2);

%calculate sigma2424
sigma24241 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    (weight(12)+deltaweight).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma24242 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    (weight(12)-deltaweight).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));
sigma24241 = sigma24241((~isinf(sigma24241)));
sigma24242 = sigma24242((~isinf(sigma24242)));
sigma2424 = (sum(sigma24241)+sum(sigma24242)-2.*Likelihood18)./(deltaweight.^2);

%calculate sigma2525
sigma25251 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),(group(13)+deltaage))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma25252 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),(group(13)-deltaage))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma25251 = sigma25251((~isinf(sigma25251)));
sigma25252 = sigma25252((~isinf(sigma25252)));
sigma2525 = (sum(sigma25251)+sum(sigma25252)-2.*Likelihood18)./(deltaage.^2);

%calculate sigma2626
sigma26261 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    (weight(13)+deltaweight).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma26262 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    (weight(13)-deltaweight).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma26261 = sigma26261((~isinf(sigma26261)));
sigma26262 = sigma26262((~isinf(sigma26262)));
sigma2626 = (sum(sigma26261)+sum(sigma26262)-2.*Likelihood18)./(deltaweight.^2);


%calculate sigma2727
sigma27271 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),(group(14)+deltaage))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma27272 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),(group(14)-deltaage))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma27271 = sigma27271((~isinf(sigma27271)));
sigma27272 = sigma27272((~isinf(sigma27272)));
sigma2727 = (sum(sigma27271)+sum(sigma27272)-2.*Likelihood18)./(deltaage.^2);

%calculate sigma2828
sigma28281 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    (weight(14)+deltaweight).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma28282 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    (weight(14)-deltaweight).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma28281 = sigma28281((~isinf(sigma28281)));
sigma28282 = sigma28282((~isinf(sigma28282)));
sigma2828 = (sum(sigma28281)+sum(sigma28282)-2.*Likelihood18)./(deltaweight.^2);

%calculate sigma2929
sigma29291 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),(group(15)+deltaage))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma29292 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),(group(15)-deltaage))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma29291 = sigma29291((~isinf(sigma29291)));
sigma29292 = sigma29292((~isinf(sigma29292)));
sigma2929 = (sum(sigma29291)+sum(sigma29292)-2.*Likelihood18)./(deltaage.^2);

%calculate sigma3030
sigma30301 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    (weight(15)+deltaweight).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma30302 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    (weight(15)-deltaweight).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma30301 = sigma30301((~isinf(sigma30301)));
sigma30302 = sigma30302((~isinf(sigma30302)));
sigma3030 = (sum(sigma30301)+sum(sigma30302)-2.*Likelihood18)./(deltaweight.^2);

%calculate sigma3131
sigma31311 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),(group(16)+deltaage))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma31312 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),(group(16)-deltaage))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma31311 = sigma31311((~isinf(sigma31311)));
sigma31312 = sigma31312((~isinf(sigma31312)));
sigma3131 = (sum(sigma31311)+sum(sigma31312)-2.*Likelihood18)./(deltaage.^2);

%calculate sigma3232
sigma32321 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    (weight(16)+deltaweight).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma32322 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    (weight(16)-deltaweight).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma32321 = sigma32321((~isinf(sigma32321)));
sigma32322 = sigma32322((~isinf(sigma32322)));
sigma3232 = (sum(sigma32321)+sum(sigma32322)-2.*Likelihood18)./(deltaweight.^2);

%calculate sigma3333
sigma33331 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),(group(17)+deltaage))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma33332 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),(group(17)-deltaage))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma33331 = sigma33331((~isinf(sigma33331)));
sigma33332 = sigma33332((~isinf(sigma33332)));
sigma3333 = (sum(sigma33331)+sum(sigma33332)-2.*Likelihood18)./(deltaage.^2);

%calculate sigma3434
sigma34341 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    (weight(17)+deltaweight).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma34342 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    (weight(17)-deltaweight).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),group(18)));

sigma34341 = sigma34341((~isinf(sigma34341)));
sigma34342 = sigma34342((~isinf(sigma34342)));
sigma3434 = (sum(sigma34341)+sum(sigma34342)-2.*Likelihood18)./(deltaweight.^2);

%calculate sigma3535
sigma35351 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),(group(18)+deltaage)));

sigma35352 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    weight(18).*distribution(data(:,1),bzc(18),(group(18)-deltaage)));

sigma35351 = sigma35351((~isinf(sigma35351)));
sigma35352 = sigma35352((~isinf(sigma35352)));
sigma3535 = (sum(sigma35351)+sum(sigma35352)-2.*Likelihood18)./(deltaage.^2);

%calculate sigma3636
sigma36361 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    (weight(18)+deltaweight).*distribution(data(:,1),bzc(18),group(18)));

sigma36362 = -log(weight(1).*distribution(data(:,1),bzc(1),group(1))+...
    weight(2).*distribution(data(:,1),bzc(2),group(2))+...
    weight(3).*distribution(data(:,1),bzc(3),group(3))+...
    weight(4).*distribution(data(:,1),bzc(4),group(4))+...
    weight(5).*distribution(data(:,1),bzc(5),group(5))+...
    weight(6).*distribution(data(:,1),bzc(6),group(6))+...
    weight(7).*distribution(data(:,1),bzc(7),group(7))+...
    weight(8).*distribution(data(:,1),bzc(8),group(8))+...
    weight(9).*distribution(data(:,1),bzc(9),group(9))+...
    weight(10).*distribution(data(:,1),bzc(10),group(10))+...
    weight(11).*distribution(data(:,1),bzc(11),group(11))+...
    weight(12).*distribution(data(:,1),bzc(12),group(12))+...
    weight(13).*distribution(data(:,1),bzc(13),group(13))+...
    weight(14).*distribution(data(:,1),bzc(14),group(14))+...
    weight(15).*distribution(data(:,1),bzc(15),group(15))+...
    weight(16).*distribution(data(:,1),bzc(16),group(16))+...
    weight(17).*distribution(data(:,1),bzc(17),group(17))+...
    (weight(18)-deltaweight).*distribution(data(:,1),bzc(18),group(18)));

sigma36361 = sigma36361((~isinf(sigma36361)));
sigma36362 = sigma36362((~isinf(sigma36362)));
sigma3636 = (sum(sigma36361)+sum(sigma36362)-2.*Likelihood18)./(deltaweight.^2);

sigma = [sigma11;sigma22;sigma33;sigma44;sigma55;sigma66;sigma77;sigma88;sigma99;sigma1010;sigma1111;...
    sigma1212;sigma1313;sigma1414;sigma1515;sigma1616;sigma1717;sigma1818;sigma1919;sigma2020;sigma2121;...
    sigma2222;sigma2323;sigma2424;sigma2525;sigma2626;sigma2727;sigma2828;sigma2929;sigma3030;sigma3131;...
    sigma3232;sigma3333;sigma3434;sigma3535;sigma3636];

covinv = zeros(2*length(weight));
for i = 1:2*length(weight)
    covinv(i,i) = sigma(i);
end

sigmaall = pinv(covinv);
sigmaage = zeros(length(weight));

diagnose = diag(sigmaall);

for i = 1:length(weight)
    sigmaage(i,i) = diagnose(i*2-1);
end

end

